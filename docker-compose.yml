version: '3.1'

services:
    database:
        image: mysql
        container_name: microservice-db
        restart: always
        expose:
            - '3306'
        environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_DATABASE: 'microservice'
        healthcheck:
            test: "exit 0"
    server:
        build:
            context: service-status-server
        depends_on:
            - database
        image: amt/status-server
        environment:
            SPRING_DATASOURCE_URL: 'jdbc:mysql://database:3306/microservice'
        ports:
            - '8080:8080'
        restart: always
